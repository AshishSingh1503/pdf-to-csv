# Server-side example environment variables (copy to server/.env or top-level .env)
# Tune these for your environment; defaults are provided in code when not set.

# Server
PORT=5000
NODE_ENV=development
LOG_LEVEL=info            # debug|info|warn|error
WS_PATH=/ws

# Database / Postgres (Cloud SQL friendly)
DB_HOST=localhost
DB_PORT=5432
DB_NAME=pdf2csv_db
DB_USER=postgres
DB_PASSWORD=postgres
DB_SSL=false
# Connection pool sizing - adjust to your DB instance limits (150-200 is common for heavy traffic)
DB_POOL_MAX=200
DB_POOL_MIN=2

# Worker & cache tuning
# WORKER_THREAD_POOL_SIZE - base # of worker threads used for CPU-bound tasks. Keep modest (e.g. number of CPU cores or 2-4).
WORKER_THREAD_POOL_SIZE=4
# CACHE_TTL seconds for node-cache
CACHE_TTL=300

# Bulk insert chunk size - protects against parameter limits / memory pressure
DB_INSERT_CHUNK_SIZE=1000

# ==============================
# Batch Queue Configuration
# ==============================
# Maximum number of batches to process concurrently (default: 2)
MAX_CONCURRENT_BATCHES=2
# Timeout for batch processing in milliseconds (default: 900000 = 15 minutes)
# Increase this if your batches take longer (e.g., large PDFs, slow Document AI).
BATCH_QUEUE_TIMEOUT=900000
# Enable verbose queue operation logging (default: false, use for debugging)
ENABLE_QUEUE_LOGGING=false
# Average batch processing time in seconds for ETA estimation (default: 150 = 2.5 minutes)
AVERAGE_BATCH_SECONDS=150
# Maximum number of queued batches to retain before rejecting new uploads. Helps prevent OOM under heavy load.
# If the queue reaches this length, new enqueues will be rejected and clients should retry later.
# Default: 100
MAX_QUEUE_LENGTH=100
# Controls whether the server should attempt a graceful shutdown by waiting for active batches to finish.
# If unset the default is enabled. Set to 'false' to disable graceful shutdown behavior.
ENABLE_GRACEFUL_SHUTDOWN=true
# How long (ms) to wait for active batches during graceful shutdown before forcing exit. Default: 300000 (5 minutes)
GRACEFUL_SHUTDOWN_TIMEOUT=300000

# Logging rotation options are controlled by winston config (logs/ directory)

# Google / Document AI
GOOGLE_APPLICATION_CREDENTIALS=./server/src/config/pdf2csv-credentials.json
PROJECT_ID=pdf2csv-475708
LOCATION=us
PROCESSOR_ID=9f82bf3d2a02e2ab

# Storage
INPUT_BUCKET=pdf-data-extraction-input-bucket
OUTPUT_BUCKET=pdf-data-extraction-output-bucket

# Feature toggles
ENABLE_DUPLICATE_DETECTION=false
DUPLICATE_KEY_FIELD=mobile

# Admin API key for /api/admin endpoints (internal use only)
# Set a strong random value in production. Example: ADMIN_API_KEY=changeme
ADMIN_API_KEY=
